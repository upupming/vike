function we(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function U(e,t){let n;{var r=Error.stackTraceLimit;Error.stackTraceLimit=1/0,n=new Error(e),Error.stackTraceLimit=r}return we()&&(n.stack=ve(n.stack,t)),n}function ve(e,t){if(!e)return e;const n=be(e);let r=0;return n.filter(o=>o.includes(" (internal/")||o.includes(" (node:internal")?!1:r<t&&Re(o)?(r++,!1):!0).join(`
`)}function Re(e){return e.startsWith("    at ")}function be(e){return e.split(/\r?\n/)}function L(e,t){const n=globalThis.__vite_plugin_ssr=globalThis.__vite_plugin_ssr||{};return n[e]=n[e]||t}function v(e){return typeof e=="object"&&e!==null}function B(e){return Array.from(new Set(e))}const w=L("assertPackageInstances.ts",{instances:[],alreadyLogged:new Set}),oe="The client runtime of Server Routing as well as the client runtime of Client Routing are both being loaded. Make sure they aren't loaded both at the same time for a given page. See https://vite-plugin-ssr.com/client-runtimes-conflict",H="Two vite-plugin-ssr client runtime instances are being loaded. Make sure your client-side bundles don't include vite-plugin-ssr twice. (In order to reduce the size of your client-side JavaScript bundles.)";function G(){{const e=B(w.instances);if(e.length>1){const t=`Both vite-plugin-ssr@${e[0]} and vite-plugin-ssr@${e[1]} loaded. Only one version should be loaded.`;Pe(!1,t)}}w.checkSingleInstance&&w.instances.length>1&&F(!1,H,{onlyOnce:!0,showStackTrace:!0})}function Ut(e){F(w.isClientRouting!==!0,oe,{onlyOnce:!0,showStackTrace:!0}),F(w.isClientRouting===void 0,H,{onlyOnce:!0,showStackTrace:!0}),w.isClientRouting=!1,e&&(w.checkSingleInstance=!0),G()}function Bt(e){F(w.isClientRouting!==!1,oe,{onlyOnce:!0,showStackTrace:!0}),F(w.isClientRouting===void 0,H,{onlyOnce:!0,showStackTrace:!0}),w.isClientRouting=!0,e&&(w.checkSingleInstance=!0),G()}function Se(e){w.instances.push(e),G()}function Pe(e,t){if(e)return;const n=`[vite-plugin-ssr][Wrong Usage] ${t}`;throw new Error(n)}function F(e,t,{onlyOnce:n,showStackTrace:r}){if(e)return;const s=`[vite-plugin-ssr][Warning] ${t}`;if(n){const{alreadyLogged:o}=w,a=n===!0?s:n;if(o.has(a))return;o.add(a)}console.warn(r?new Error(s):s)}const $e="0.4.137",$={projectName:"vite-plugin-ssr",projectVersion:$e,npmPackageName:"vite-plugin-ssr",githubRepository:"https://github.com/brillout/vite-plugin-ssr"};Se($.projectVersion);const ae=new Proxy(e=>e,{get:()=>ae}),P=ae,m=L("utils/assert.ts",{alreadyLogged:new Set,logger(e,t){t==="info"?console.log(e):console.warn(e)},showStackTraceList:new WeakSet}),Te=`[${$.npmPackageName}]`,_e=`[${$.npmPackageName}@${$.projectVersion}]`,M=2;function i(e,t){var o;if(e)return;const n=(()=>{if(!t)return null;const a=typeof t=="string"?t:"`"+JSON.stringify(t)+"`";return`Debug info (this is for the ${$.projectName} maintainers; you can ignore this): ${a}`})();let r=[`You stumbled upon a bug in ${$.projectName}'s source code.`,`Go to ${$.githubRepository}/issues/new and copy-paste this error; a maintainer will fix the bug (usually under 24 hours).`,n].filter(Boolean).join(" ");r=I(r),r=W(r,"Bug"),r=O(r,!0);const s=U(r,M);throw(o=m.onBeforeLog)==null||o.call(m),s}function p(e,t,{showStackTrace:n}={}){var s;if(e)return;t=I(t),t=W(t,"Wrong Usage"),t=O(t);const r=U(t,M);throw n&&m.showStackTraceList.add(r),(s=m.onBeforeLog)==null||s.call(m),r}function Le(e){return e=I(e),e=W(e,"Error"),e=O(e),U(e,M)}function T(e,t,{onlyOnce:n,showStackTrace:r}){var s;if(!e){if(t=I(t),t=W(t,"Warning"),t=O(t),n){const{alreadyLogged:o}=m,a=n===!0?t:n;if(o.has(a))return;o.add(a)}if((s=m.onBeforeLog)==null||s.call(m),r){const o=new Error(t);m.showStackTraceList.add(o),m.logger(o,"warn")}else m.logger(t,"warn")}}function Ht(e,t,{onlyOnce:n}){var r;if(!e){if(t=I(t),t=O(t),n){const{alreadyLogged:s}=m,o=t;if(s.has(o))return;s.add(o)}(r=m.onBeforeLog)==null||r.call(m),m.logger(t,"info")}}function W(e,t){let n=`[${t}]`;const r=t==="Warning"?"yellow":"red";return n=P.bold(P[r](n)),`${n}${e}`}function I(e){return e.startsWith("[")?e:` ${e}`}function O(e,t=!1){return`${t?_e:Te}${e}`}function J(){return typeof window<"u"&&typeof window.scrollY=="number"}const x=L("utils/assertRouterType.ts",{});function Gt(){le(Fe()),x.isClientRouting=!0}function Fe(){return x.isClientRouting!==!1}function Mt(){le(x.isClientRouting!==!0),x.isClientRouting=!1}function le(e){p(J(),"`import { something } from 'vite-plugin-ssr/client/router'` is forbidden on the server-side",{showStackTrace:!0}),T(e,"You shouldn't `import { something } from 'vite-plugin-ssr/client/router'` when using Server Routing. The 'vite-plugin-ssr/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` as they unnecessarily bloat your client-side bundle.",{showStackTrace:!0,onlyOnce:!0})}const Ie=["js","ts","cjs","cts","mjs","mts","jsx","tsx","cjsx","ctsx","mjsx","mtsx"],ce=["vue","svelte","marko","md","mdx"],Oe=[...Ie,...ce];function ue(e){const t=Oe.some(n=>e.endsWith("."+n));return i(!ke(e)||t),t}function ke(e){return/\.(c|m)?(j|t)sx?$/.test(e)}function xe(e){return ce.some(t=>e.endsWith("."+t))}function j(e,t,n){return typeof e=="string"?X(e.split(""),t,n).join(""):X(e,t,n)}function X(e,t,n){const r=[];let s=t>=0?t:e.length+t;i(s>=0&&s<=e.length);let o=n>=0?n:e.length+n;for(i(o>=0&&o<=e.length);!(s===o||(s===e.length&&(s=0),s===o));){const a=e[s];i(a!==void 0),r.push(a),s++}return r}function fe(e){return e.startsWith("/")||e.startsWith("http")||e.startsWith("tauri://")||e.startsWith(".")||e.startsWith("?")||e.startsWith("#")||e===""}function Jt(e,t){i(t.includes(" but ")),p(typeof e=="string",`${t} should be a string`),!fe(e)&&(!e.startsWith("/")&&!e.includes(":")?p(!1,`${t} is '${e}' and it should be '/${e}' instead (URL pathnames should start with a leading slash)`):p(!1,`${t} isn't a valid URL`))}function je(e,t){i(fe(e),{url:e}),i(t.startsWith("/"),{url:e,baseServer:t});const[n,...r]=e.split("#");i(n!==void 0);const s=["",...r].join("#")||null;i(s===null||s.startsWith("#"));const o=s===null?"":N(s.slice(1)),[a,...l]=n.split("?");i(a!==void 0);const c=["",...l].join("?")||null;i(c===null||c.startsWith("?"),{url:e,searchOriginal:c});const u={},g={};Array.from(new URLSearchParams(c||"")).forEach(([b,K])=>{u[b]=K,g[b]=[...g[b]||[],K]});const{origin:f,pathnameResolved:E}=We(a,t);i(f===null||f===N(f),{origin:f}),i(E.startsWith("/"),{url:e,pathnameResolved:E}),i(f===null||e.startsWith(f),{url:e,origin:f});const h=a.slice((f||"").length);ze(e,f,h,c,s);let{pathname:y,hasBaseServer:R}=Ae(E,t);return y=Ce(y),i(y.startsWith("/")),{origin:f,pathname:y,pathnameOriginal:h,hasBaseServer:R,search:u,searchAll:g,searchOriginal:c,hash:o,hashOriginal:s}}function N(e){try{return decodeURIComponent(e)}catch{}try{return decodeURI(e)}catch{}return e}function Ce(e){return e.split("/").map(t=>N(t).split("/").join("%2F")).join("/")}function We(e,t){var l;if(e.startsWith("//"))return{origin:null,pathnameResolved:e};let n=!1;const r="tauri://",s="http://";e.startsWith(r)&&(n=!0,e=s+e.slice(r.length));let o,a;try{const c=new URL(e);o=c.origin,a=c.pathname}catch{o=null;let u=typeof window<"u"&&((l=window==null?void 0:window.document)==null?void 0:l.baseURI);u=u||"http://fake.example.org"+t,a=new URL(e,u).pathname}return a||(a="/"),n&&(i(o),i(o.startsWith(s)),o=r+o.slice(s.length)),i(a.startsWith("/"),{urlWithoutSearch:e,pathnameResolved:a}),i(a===a.split("?")[0].split("#")[0]),{origin:o,pathnameResolved:a}}function De(e){i(e.startsWith("/")),i(!e.includes("?")),i(!e.includes("#"))}function Ae(e,t){De(e),i(Ne(t));let n=e;if(i(n.startsWith("/")),i(t.startsWith("/")),t==="/")return{pathname:e,hasBaseServer:!0};let r=t;return t.endsWith("/")&&n===j(t,0,-1)&&(r=j(t,0,-1),i(n===r)),n.startsWith(r)?(i(n.startsWith("/")||n.startsWith("http")),i(n.startsWith(r)),n=n.slice(r.length),n.startsWith("/")||(n="/"+n),i(n.startsWith("/")),{pathname:n,hasBaseServer:!0}):{pathname:e,hasBaseServer:!1}}function Ne(e){return e.startsWith("/")}function ze(e,t,n,r,s){const o=Ve(t,n,r,s);i(e===o,{url:e,urlRecreated:o})}function Ve(e,t,n,r){return`${e||""}${t}${n||""}${r||""}`}function Y(e,t){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}function D(e){return e instanceof Function||typeof e=="function"}function Yt(e){return(t,n)=>{const r=e(t),s=e(n);return r===s?0:r>s?-1:1}}function Ue(e){return(t,n)=>{const r=e(t),s=e(n);if(i([!0,!1,null].includes(r)),i([!0,!1,null].includes(s)),r===s)return 0;if(r===!0||s===!1)return-1;if(s===!0||r===!1)return 1;i(!1)}}function Be(e){return Ue(t=>{const n=e(t);return n===null?null:!n})}function d(e,t,n="unknown"){if(!v(e))return!1;if(!(t in e))return n==="undefined";if(n==="unknown")return!0;const r=e[t];return n==="array"?Array.isArray(r):n==="object"?v(r):n==="string[]"?Array.isArray(r)&&r.every(s=>typeof s=="string"):n==="function"?D(r):Array.isArray(n)?typeof r=="string"&&n.includes(r):n==="null"?r===null:n==="undefined"?r===void 0:n==="true"?r===!0:n==="false"?r===!1:typeof r===n}function He(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}const Ge=e=>e!=null;function de(e){const t=n=>`Not a posix path: ${n}`;i(e!==null,t("null")),i(typeof e=="string",t(`typeof path === '${typeof e}'`)),i(e!=="",t("(empty string)")),i(e),i(!e.includes("\\"),t(e))}const Me=["$$registrations","_rerender_only"],Je=[".md",".mdx"];function Ye(e,t){qe(e,t,!0)}function qe(e,t,n){const s=Object.keys(e).filter(l=>!Me.includes(l)),o=s.filter(l=>l!=="default"),a=s.includes("default");if(o.length===0){if(a)return;i(s.length===0),p(!1,`${t} doesn't export any value, but it should have a \`export default\` instead`)}else if(!Je.some(l=>t.endsWith(l))){const l=o.join(", ");n?T(o.length===0,`${t} should only have a default export: remove \`export { ${l} }\``,{onlyOnce:!0}):T(o.length===0,`${t} replace \`export { ${l} }\` with \`export default { ${l} }\``,{onlyOnce:!0})}}function Ke(e){return Object.entries(e)}const Xe=["clientRouting"];function Qe(e){Xe.forEach(t=>{if(i(e.fileExports),!(t in e.fileExports))return;const n=`The value of \`${t}\` is only allowed to be \`true\`.`;p(e.fileExports[t]!==!1,`${e.filePath} has \`export { ${t} }\` with the value \`false\` which is prohibited: remove \`export { ${t} }\` instead. (${n})`),p(e.fileExports[t]===!0,`${e.filePath} has \`export { ${t} }\` with a forbidden value. ${n}`)})}const ge=["render","clientRouting","prerender","doNotPrerender"];function Ze(e,t){p(!ge.includes(e),`${t} has \`export default { ${e} }\` which is prohibited, use \`export { ${e} }\` instead.`)}function et(e,t){const n={},r={},s={};if(e.forEach(l=>{tt(l).forEach(({exportName:u,exportValue:g,isFromDefaultExport:f})=>{i(u!=="default"),s[u]=s[u]??[],s[u].push({exportValue:g,exportSource:`${l.filePath} > ${f?`\`export default { ${u} }\``:`\`export { ${u} }\``}`,filePath:l.filePath,_filePath:l.filePath,_fileType:l.fileType,_isFromDefaultExport:f})})}),t){const{configValues:l}=t;Ke(l).forEach(([c,u])=>{const g=t.configElements[c];i(g);const{configDefinedByFile:f,configDefinedAt:E}=g;i(f),r[c]=r[c]??u,n[c]=n[c]??[],i(n[c].length===0),n[c].push({configValue:u,configDefinedAt:E,configDefinedByFile:f});const h=c;s[h]=s[h]??[],s[h].push({exportValue:u,exportSource:E,filePath:f,_filePath:f,_fileType:null,_isFromDefaultExport:null})})}const o=nt(),a={};return Object.entries(s).forEach(([l,c])=>{c.forEach(({exportValue:u,_fileType:g,_isFromDefaultExport:f})=>{a[l]=a[l]??u,g===".page"&&!f&&(l in o||(o[l]=u))})}),i(!("default"in a)),i(!("default"in s)),{config:r,configEntries:n,exports:a,exportsAll:s,pageExports:o}}function tt(e){const{filePath:t,fileExports:n}=e;i(n),i(ue(t));const r=[];return Object.entries(n).sort(Be(([s])=>s==="default")).forEach(([s,o])=>{let a=s==="default";if(a)if(xe(t))s="Page";else{p(v(o),`The \`export default\` of ${t} should be an object.`),Object.entries(o).forEach(([l,c])=>{Ze(l,t),r.push({exportName:l,exportValue:c,isFromDefaultExport:a})});return}r.push({exportName:s,exportValue:o,isFromDefaultExport:a})}),r.forEach(({exportName:s,isFromDefaultExport:o})=>{i(!(o&&ge.includes(s)))}),r}function nt(){return new Proxy({},{get(...e){return J()||T(!1,"`pageContext.pageExports` is outdated. Use `pageContext.exports` instead, see https://vite-plugin-ssr.com/exports",{onlyOnce:!0,showStackTrace:!0}),Reflect.get(...e)}})}function rt(e){const t=".page.",n=j(e.split(t),0,-1).join(t);return i(!n.includes("\\")),n}function _(e){de(e)}function qt(e,t){if(t.length>0){const r=t.filter(s=>s.isErrorPage);return r.length===0?null:(p(r.length===1,"Only one error page can be defined"),r[0].pageId)}const n=B(e.map(({pageId:r})=>r).filter(r=>A(r)));if(p(n.length<=1,`Only one _error.page.js is allowed, but found several: ${n.join(" ")}`),n.length>0){const r=n[0];return i(r),r}return null}function A(e,t){return i(!e.includes("\\")),e.includes("/_error")}function st(e,t){if(t.length>0){const n=t.find(r=>r.pageId===e);return i(n),n.isErrorPage}else return A(e)}const it=[".page",".page.server",".page.route",".page.client",".css"];function ot(e){if(de(e),e.endsWith(".css"))return".css";i(ue(e),e);const n=e.split("/").slice(-1)[0].split("."),r=n.slice(-3)[0],s=n.slice(-2)[0];if(s==="page")return".page";if(i(r==="page",e),s==="server")return".page.server";if(s==="client")return".page.client";if(s==="route")return".page.route";i(!1,e)}function he(e){const t=o=>s.pageId===o||s.isDefaultPageFile&&(Q(s.filePath)||at(o,s.filePath)),n=ot(e),s={filePath:e,fileType:n,isEnv:o=>{if(i(n!==".page.route"),o==="CLIENT_ONLY")return n===".page.client"||n===".css";if(o==="SERVER_ONLY")return n===".page.server";if(o==="CLIENT_AND_SERVER")return n===".page";i(!1)},isRelevant:t,isDefaultPageFile:z(e),isRendererPageFile:n!==".css"&&z(e)&&Q(e),isErrorPageFile:A(e),pageId:rt(e)};return s}function z(e){return _(e),A(e)?!1:e.includes("/_default")}function Q(e){return _(e),e.includes("/renderer/")}function at(e,t){_(e),_(t),i(!e.endsWith("/")),i(!t.endsWith("/")),i(z(t));const n=j(t.split("/"),0,-1).filter(r=>r!=="_default").join("/");return e.startsWith(n)}function lt(e){i(Array.isArray(e)||e===null),i(e!==null),e.forEach(t=>{i(v(t)),i(d(t,"pageId","string")),i(d(t,"routeFilesystem","string")||d(t,"routeFilesystem","null")),i(d(t,"routeFilesystemDefinedBy","string")||d(t,"routeFilesystemDefinedBy","null")),i(d(t,"loadCodeFiles","function")),i(d(t,"isErrorPage","boolean")),i(d(t,"configElements","object")),pe(t.configElements,!1)})}function ct(e){pe(e,!0)}function pe(e,t){i(v(e)),Object.entries(e).forEach(([n,r])=>{if(i(v(r)||r===null),r===null){i(t);return}i(d(r,"configDefinedAt","string")),i(d(r,"plusConfigFilePath","string")||d(r,"plusConfigFilePath","null")),i(d(r,"configEnv","string")),i(d(r,"codeFilePath","string")||d(r,"codeFilePath","null")),i(d(r,"codeFileExport","string")||d(r,"codeFileExport","null")),i(d(r,"configValueSerialized","string")||d(r,"configValueSerialized","undefined")),(t||n==="route")&&i(d(r,"configValue")||d(r,"configValueSerialized"))})}const ut=[{is:e=>e===void 0,match:e=>e==="!undefined",serialize:()=>"!undefined",deserialize:()=>{}},{is:e=>e===1/0,match:e=>e==="!Infinity",serialize:()=>"!Infinity",deserialize:()=>1/0},{is:e=>e===-1/0,match:e=>e==="!-Infinity",serialize:()=>"!-Infinity",deserialize:()=>-1/0},{is:e=>typeof e=="number"&&isNaN(e),match:e=>e==="!NaN",serialize:()=>"!NaN",deserialize:()=>NaN},{is:e=>e instanceof Date,match:e=>e.startsWith("!Date:"),serialize:e=>"!Date:"+e.toISOString(),deserialize:e=>new Date(e.slice(6))},{is:e=>typeof e=="bigint",match:e=>e.startsWith("!BigInt:"),serialize:e=>"!BigInt:"+e.toString(),deserialize:e=>{if(typeof BigInt>"u")throw new Error("Your JavaScript environement does not support BigInt. Consider adding a polyfill.");return BigInt(e.slice(8))}},{is:e=>e instanceof RegExp,match:e=>e.startsWith("!RegExp:"),serialize:e=>"!RegExp:"+e.toString(),deserialize:e=>{e=e.slice(8);const t=e.match(/\/(.*)\/(.*)?/),n=t[1],r=t[2];return new RegExp(n,r)}},{is:e=>e instanceof Map,match:e=>e.startsWith("!Map:"),serialize:(e,t)=>"!Map:"+t(Array.from(e.entries())),deserialize:(e,t)=>new Map(t(e.slice(5)))},{is:e=>e instanceof Set,match:e=>e.startsWith("!Set:"),serialize:(e,t)=>"!Set:"+t(Array.from(e.values())),deserialize:(e,t)=>new Set(t(e.slice(5)))},{is:e=>typeof e=="string"&&e.startsWith("!"),match:e=>e.startsWith("!"),serialize:e=>"!"+e,deserialize:e=>e.slice(1)}];function q(e){const t=JSON.parse(e);return me(t)}function me(e){return typeof e=="string"?ft(e):(typeof e=="object"&&e!==null&&Object.entries(e).forEach(([t,n])=>{e[t]=me(n)}),e)}function ft(e){for(const{match:t,deserialize:n}of ut)if(t(e))return n(e,q);return e}function dt(e){e.forEach(t=>{Object.entries(t.configElements).forEach(([n,r])=>{gt(r),n==="route"&&ht(r)})})}function gt(e){const{configValueSerialized:t}=e;t!==void 0&&(e.configValue=q(t))}function ht(e){i(d(e,"configValue"));const{configValue:t}=e,n=typeof t;p(n==="string"||D(t),`${e.configDefinedAt} has an invalid type '${n}': it should be a string or a function instead, see https://vite-plugin-ssr.com/route`)}function pt(e){i(d(e,"isGeneratedFile")),i(e.isGeneratedFile!==!1,"vite-plugin-ssr was re-installed(/re-built). Restart your app."),i(e.isGeneratedFile===!0,`\`isGeneratedFile === ${e.isGeneratedFile}\``),i(d(e,"pageFilesLazy","object")),i(d(e,"pageFilesEager","object")),i(d(e,"pageFilesExportNamesLazy","object")),i(d(e,"pageFilesExportNamesEager","object")),i(d(e.pageFilesLazy,".page")),i(d(e.pageFilesLazy,".page.client")||d(e.pageFilesLazy,".page.server")),i(d(e,"pageFilesList","string[]")),i(d(e,"pageConfigs")),i(d(e,"pageConfigGlobal"));const{pageConfigs:t,pageConfigGlobal:n}=e;lt(t),dt(t),ct(n);const r={};k(e.pageFilesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{a=r[o]=r[o]??a;const c=l;Z(c),a.loadFile=async()=>{"fileExports"in a||(a.fileExports=await c(),Qe(a))}}),k(e.pageFilesExportNamesLazy).forEach(({filePath:o,pageFile:a,globValue:l})=>{a=r[o]=r[o]??a;const c=l;Z(c),a.loadExportNames=async()=>{if(!("exportNames"in a)){const u=await c();p("exportNames"in u,"You seem to be using Vite 2 but the latest vite-plugin-ssr versions only work with Vite 3"),i(d(u,"exportNames","string[]"),a.filePath),a.exportNames=u.exportNames}}}),k(e.pageFilesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{a=r[o]=r[o]??a;const c=l;i(v(c)),a.fileExports=c}),k(e.pageFilesExportNamesEager).forEach(({filePath:o,pageFile:a,globValue:l})=>{a=r[o]=r[o]??a;const c=l;i(v(c)),i(d(c,"exportNames","string[]"),a.filePath),a.exportNames=c.exportNames}),e.pageFilesList.forEach(o=>{r[o]=r[o]??he(o)});const s=Object.values(r);return s.forEach(({filePath:o})=>{i(!o.includes("\\"))}),{pageFiles:s,pageConfigs:t,pageConfigGlobal:n}}function k(e){const t=[];return Object.entries(e).forEach(([n,r])=>{i(it.includes(n)),i(v(r)),Object.entries(r).forEach(([s,o])=>{const a=he(s);i(a.fileType===n),t.push({filePath:s,pageFile:a,globValue:o})})}),t}function Z(e){i(D(e))}const S=L("setPageFiles.ts",{});function Kt(e){const{pageFiles:t,pageConfigs:n,pageConfigGlobal:r}=pt(e);S.pageFilesAll=t,S.pageConfigs=n,S.pageConfigGlobal=r}async function Xt(e,t){e?(i(!S.pageFilesGetter),i(t===void 0)):(i(S.pageFilesGetter),i(typeof t=="boolean"),(!S.pageFilesAll||!t)&&await S.pageFilesGetter());const{pageFilesAll:n,pageConfigs:r,pageConfigGlobal:s}=S;i(n&&r&&s);const o=mt(n,r);return{pageFilesAll:n,allPageIds:o,pageConfigs:r,pageConfigGlobal:s}}function mt(e,t){const n=e.filter(({isDefaultPageFile:o})=>!o).map(({pageId:o})=>o),r=B(n),s=t.map(o=>o.pageId);return[...r,...s]}function yt(e,t){return ye(e,t,!0)}function Qt(e,t){return ye(e,t,!1)}function ye(e,t,n){const r=n?"CLIENT_ONLY":"SERVER_ONLY",s=e.filter(h=>h.isRelevant(t)&&h.fileType!==".page.route").sort(Et(n,t)),o=h=>{const y=s.filter(b=>b.pageId===t&&b.isEnv(h?"CLIENT_AND_SERVER":r));p(y.length<=1,`Merge the following files into a single file: ${y.map(b=>b.filePath).join(" ")}`);const R=y[0];return i(R===void 0||!R.isDefaultPageFile),R},a=o(!1),l=o(!0),c=h=>s.filter(y=>y.isRendererPageFile&&y.isEnv(h?"CLIENT_AND_SERVER":r))[0],u=c(!1),g=c(!0),f=s.filter(h=>h.isDefaultPageFile&&!h.isRendererPageFile&&(h.isEnv(r)||h.isEnv("CLIENT_AND_SERVER")));return[a,l,...f,u,g].filter(Ge)}function Et(e,t){const n=e?"CLIENT_ONLY":"SERVER_ONLY",r=-1,s=1,o=0;return(a,l)=>{if(!a.isDefaultPageFile&&l.isDefaultPageFile)return r;if(!l.isDefaultPageFile&&a.isDefaultPageFile)return s;{const c=a.isRendererPageFile,u=l.isRendererPageFile;if(!c&&u)return r;if(!u&&c)return s;i(c===u)}{const c=ee(t,a.filePath),u=ee(t,l.filePath);if(c<u)return r;if(u<c)return s;i(c===u)}{if(a.isEnv(n)&&l.isEnv("CLIENT_AND_SERVER"))return r;if(l.isEnv(n)&&a.isEnv("CLIENT_AND_SERVER"))return s}return o}}function ee(e,t){_(e),_(t);let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);const r=e.slice(n),s=t.slice(n),o=r.split("/").length,a=s.split("/").length;return o+a}const wt="modulepreload",vt=function(e){return"/"+e},te={},Zt=function(t,n,r){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=vt(o),o in te)return;te[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let g=s.length-1;g>=0;g--){const f=s[g];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":wt,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((g,f)=>{u.addEventListener("load",g),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})};function Rt(){i(J())}function bt(){Rt()}function ne(e){const t=e/1e3;if(t<120){const n=re(t);return`${n} second${se(n)}`}{const n=t/60,r=re(n);return`${r} minute${se(r)}`}}function re(e){let t=e.toFixed(1);return t.endsWith(".0")&&(t=t.slice(0,-2)),t}function se(e){return e==="1"?"":"s"}const St=L("utils/executeHook.ts",{userHookErrors:new Map});function Pt(e,t,n){const{timeoutErr:r,timeoutWarn:s}=$t(t);let o,a;const l=new Promise((f,E)=>{o=h=>{c(),f(h)},a=h=>{c(),E(h)}}),c=()=>{clearTimeout(u),clearTimeout(g)},u=setTimeout(()=>{T(!1,`The ${t}() hook defined by ${n} is taking more than ${ne(s)}`,{onlyOnce:!1})},s),g=setTimeout(()=>{const f=Le(`Hook timeout: the ${t}() hook defined by ${n} didn't finish after ${ne(r)}`);a(f)},r);return(async()=>{try{const f=await e();o(f)}catch(f){v(f)&&St.userHookErrors.set(f,{hookName:t,hookFilePath:n}),a(f)}})(),l}function $t(e){return e==="onBeforeRoute"?{timeoutErr:5*1e3,timeoutWarn:1*1e3}:e==="onBeforePrerender"?{timeoutErr:10*60*1e3,timeoutWarn:30*1e3}:{timeoutErr:40*1e3,timeoutWarn:4*1e3}}function en(e){const t=window.location.href,{searchOriginal:n,hashOriginal:r,pathname:s}=je(t,"/");let o;return e!=null&&e.withoutHash?o=`${s}${n||""}`:o=`${s}${n||""}${r||""}`,i(o.startsWith("/")),o}bt();function tn(){const e="vite-plugin-ssr_pageContext",t=document.getElementById(e);p(t,`The element #${e} (which vite-plugin-ssr automatically injects into the HTML) is missing from the DOM. This may happen if your HTML is malformed. Make sure your HTML isn't malformed, and make sure you don't remove #${e} from the HTML nor from the DOM.`);const n=t.textContent;i(n);const r=q(n);return i(d(r,"_pageId","string")),Y(r,{_hasPageContextFromServer:!0}),r}function V(e,t){if(!(t in e.exports))return null;const n=e.exports[t],r=e.exportsAll[t][0];if(i(r.exportValue===n),n===null)return null;const s=r.exportSource;return i(s),i(!t.endsWith(")")),p(D(n),`hook ${t}() defined by ${s} should be a function`),{hookFn:n,hookName:t,hookFilePath:s}}function nn(e,t){V(e,t)}function Tt(e){const t=Object.entries(e);for(const n in e)delete e[n];t.sort(([n],[r])=>He(n,r)).forEach(([n,r])=>{e[n]=r})}function _t(e){Lt(e),Ft(e)}function Lt(e){st(e._pageId,e._pageConfigs)&&i(d(e,"is404","boolean"))}function Ft(e){if(e.is404===void 0||e.is404===null)return;const t=e.pageProps||{};if(!v(t)){T(!1,"pageContext.pageProps should be an object",{showStackTrace:!0,onlyOnce:!0});return}t.is404=t.is404||e.is404,e.pageProps=t}const It="not-serializable",C=L("getPageContextProxyForUser.ts",{});function Ot(e){return i([!0,!1].includes(e._hasPageContextFromServer)),i([!0,!1].includes(e._hasPageContextFromClient)),new Proxy(e,{get(t,n){const r=e[n],s=JSON.stringify(n);return p(r!==It,`pageContext[${s}] couldn't be serialized and, therefore, is missing on the client-side. Check the server logs for more information.`),kt(e,n,`pageContext[${s}] isn't available on the client-side because ${s} is missing in passToClient, see https://vite-plugin-ssr.com/passToClient`),r}})}function kt(e,t,n){C.prev===t||C.prev==="__v_raw"||(Ct(t),!(t in e)&&(jt(t)||e._hasPageContextFromServer&&!e._hasPageContextFromClient&&p(!1,n)))}const xt=["then","toJSON"];function jt(e){return!!(xt.includes(e)||typeof e=="symbol"||typeof e!="string"||e.startsWith("__v_"))}function Ct(e){C.prev=e,window.setTimeout(()=>{C.prev=void 0},0)}function Wt(e,t){if(t){const s=e;i([!0,!1].includes(s.isHydration)),i([!0,!1,null].includes(s.isBackwardNavigation))}else{const s=e;i(s.isHydration===!0),i(s.isBackwardNavigation===null)}i("config"in e),i("configEntries"in e),i("exports"in e),i("exportsAll"in e),i("pageExports"in e),i(v(e.pageExports));const n=e.exports.Page;Y(e,{Page:n}),Dt(e),Tt(e);const r=Ot(e);return _t(e),r}function Dt(e){Object.entries(e).forEach(([t,n])=>{delete e[t],e[t]=n})}function At(e,t){const n=e.filter(s=>s.pageId===t);return i(n.length<=1),n[0]??null}async function Nt(e,t){const n={};return!t&&"configValues"in e||((await e.loadCodeFiles()).forEach(s=>{const{configName:o,codeFilePath:a}=s;if(s.isPlusFile){const{codeFileExports:l}=s;o!=="client"&&Ye(l,a),Object.entries(l).forEach(([c,u])=>{const g=c!=="default",f=g?c:s.configName,E=u;if(n[f]=E,ie(E,f,a),g){const h=e.configElements[s.configName];i(h),e.configElements[f]={configValue:E,codeFileExport:c,codeFilePath:a,configDefinedByFile:a,configDefinedAt:`${P.bold(a)} > ${P.cyan(`export { ${c} }`)}`,configEnv:h.configEnv,plusConfigFilePath:null}}})}else{const l=s.codeFileExportValue;n[o]=l,ie(l,o,a)}}),Object.entries(e.configElements).map(([s,o])=>{o.codeFilePath||(n[s]=o.configValue)}),Y(e,{configValues:n})),e}function ie(e,t,n){i(!n.includes("+config.")),p(e!==null,`Set ${P.cyan(t)} to ${P.cyan("null")} in a ${P.bold("+config.js")} file instead of ${P.bold(n)}`)}const Ee="__whileFetchingAssets";async function rn(e,t,n){const r=yt(e,n),s=At(t,n);let o;const a=!1;try{o=(await Promise.all([s&&Nt(s,a),...r.map(y=>{var R;return(R=y.loadFile)==null?void 0:R.call(y)})]))[0]}catch(h){throw zt(h)&&Object.assign(h,{[Ee]:!0}),h}const{config:l,configEntries:c,exports:u,exportsAll:g,pageExports:f}=et(r,o);return{config:l,configEntries:c,exports:u,exportsAll:g,pageExports:f,_pageFilesLoaded:r}}function sn(e){return e?e[Ee]===!0:!1}function zt(e){return e instanceof Error?["Failed to fetch dynamically imported module","error loading dynamically imported module","Importing a module script failed","error resolving module specifier","failed to resolve module"].some(n=>e.message.toLowerCase().includes(n.toLowerCase())):!1}async function on(e,t){const n=Wt(e,t);let r=null,s;r=V(e,"render"),s="render";{const l=V(e,"onRenderClient");l&&(r=l,s="onRenderClient")}if(!r){const l=Vt(e);if(e._pageConfigs.length>0)p(!1,`No onRenderClient() hook defined for URL '${l}', but it's needed, see https://vite-plugin-ssr.com/onRenderClient`);else{const c=e._pageFilesLoaded.filter(g=>g.fileType===".page.client");let u;c.length===0?u="No file `*.page.client.*` found for URL "+l:u="One of the following files should export a `render()` hook: "+c.map(g=>g.filePath).join(" "),p(!1,u)}}i(r);const o=r.hookFn;i(s);const a=await Pt(()=>o(n),s,r.hookFilePath);p(a===void 0,`The ${s}() hook defined by ${r.hookFilePath} isn't allowed to return a value`)}function Vt(e){let t;try{t=e.urlPathname??e.urlOriginal}catch{}return t=t??window.location.href,t}export{j as A,V as B,Pt as C,Ht as D,qt as E,Wt as F,q as G,Le as H,A as I,Ne as J,yt as K,At as L,fe as M,Fe as N,sn as O,Bt as P,Zt as _,tn as a,p as b,Xt as c,T as d,Mt as e,Ut as f,en as g,on as h,nn as i,D as j,Rt as k,rn as l,Gt as m,v as n,Y as o,L as p,Qt as q,i as r,Kt as s,J as t,je as u,P as v,Ue as w,Yt as x,d as y,Jt as z};
